#!/usr/bin/env zsh

# Add tab completion for SSH hostnames based on $HOME/.ssh/config, ignoring wildcards
if [ -e "$HOME/.ssh/config" ]; then
  _ssh_hosts() {
    compadd $(grep "^Host" ~/.ssh/config | grep -v "[?*]" | cut -d " " -f2)
  }
  compdef _ssh_hosts ssh scp sftp rsync
fi

# Tab completion for nr (package.json scripts)
_nr_scripts() {
  local scripts
  if [[ -f package.json ]]; then
    scripts=(${(f)"$(command jq -r '.scripts // {} | keys[]' package.json 2>/dev/null)"})
    compadd -a scripts
  fi
}
compdef _nr_scripts nr r
